var __spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,r=0,a=arguments.length;r<a;r++)t+=arguments[r].length;for(var e=Array(t),i=0,r=0;r<a;r++)for(var n=arguments[r],s=0,o=n.length;s<o;s++,i++)e[i]=n[s];return e};System.register(["./p-00ae5dc6.system.js","./p-985215b0.system.js","./p-1a44274d.system.js"],(function(t){"use strict";var r,a,e,i,n,s,o,h,u,c,d,l,g;return{setters:[function(t){r=t.r;a=t.h;e=t.c},function(t){i=t.C},function(t){n=t.l;s=t.p;o=t.s;h=t.a;u=t.o;c=t.q;d=t.r;l=t.b;g=t.i}],execute:function(){var f={arcMargin:0,cornerRadius:0,height:300,innerRadius:50,outerRadius:100,transitionDuration:350,width:300};var p=function(t){return c(d(i),t).reverse()};var m=t("epi_donutimage",function(){function t(t){r(this,t);this.data=[];this.width=300;this.height=300;this.arcMargin=0;this.cornerRadius=0;this.innerRadius=50;this.outerRadius=100;this.transitionDuration=300;this.svg=null;this.radius=null;this.arcs=[];this.prevArcs=[];this.dataSortFn=function(t,r){return r.value-t.value};this.arcMarginScale=n().domain([0,100]).range([0,.2]).clamp(true);this.cornerRadiusScale=n().domain([0,100]).range([0,50]).clamp(true);this.innerRadiusScale=n().domain([0,100]).range([0,1]).clamp(true);this.outerRadiusScale=n().domain([0,100]).range([0,1]).clamp(true);this.pieGenerator=s().padAngle(this.arcMarginScale(this.arcMargin||0)).sort(this.dataSortFn).value((function(t){return t.value}))}t.prototype.setDataHandler=function(t){if(typeof this.data==="string")this.data=this.formatData(t)};t.prototype.formatData=function(t){var r=t;if(typeof t==="string"){try{r=JSON.parse(t)}catch(a){r=[];console.warn("Could not process data",a.message)}}return r};t.prototype.componentWillUpdate=function(){this.prevArcs=__spreadArrays(this.arcs)};t.prototype.componentDidUpdate=function(){this.rebuildChartDefs();this.drawChart()};t.prototype.componentWillLoad=function(){if(typeof this.data==="string")this.data=this.formatData(this.data)};t.prototype.componentDidLoad=function(){this.initChartRoot();this.rebuildChartDefs();this.drawChart()};t.prototype.initChartRoot=function(){if(!this.hostEl)return;var t=this.hostEl.querySelector("svg");if(!this.svg&&t){this.svg=o(t);this.svg.append("g").attr("class","donut-image-group").attr("transform","translate("+(this.width||f.width)/2+","+(this.height||f.height)/2+")")}};t.prototype.rebuildChartDefs=function(){this.radius=Math.min(this.width||f.width,this.height||f.height)/2;this.arcDef=h().outerRadius(this.radius*this.outerRadiusScale(Math.max(this.outerRadius,this.innerRadius)+1)).innerRadius(this.radius*(this.innerRadiusScale(Math.min(this.outerRadius,this.innerRadius)-1)+this.arcMarginScale(this.arcMargin||0)/2)).cornerRadius(this.cornerRadiusScale(this.cornerRadius||0)).padAngle(this.arcMarginScale(this.arcMargin||0));if(this.data&&typeof this.data!=="string"&&this.data.length){this.colourScale=u().domain(this.data.sort(this.dataSortFn).map((function(t){return t.name}))).range(this.data.length>i.length?p(this.data.length).reverse():i);this.arcs=this.pieGenerator(this.data)}};t.prototype.drawChart=function(){var t=this;if(!this.svg||!this.arcDef)return;this.svg.select("g").attr("transform","translate("+(this.width||f.width)/2+","+(this.height||f.height)/2+")").selectAll("path").data(this.arcs,(function(t){return t})).join((function(r){return r.append("path").call((function(r){return r.transition().duration(t.transitionDuration).ease(l).attr("role","presentation").attr("shape-rendering","auto").attr("fill",(function(r){return r.data.colour||r.data.color||t.colourScale(r.data.name)})).attrTween("d",(function(r){var a=t.prevArcs.filter((function(t){return t.data.name===r.data.name}))[0]||r;var e=g(a.startAngle,r.startAngle);var i=g(a.endAngle,r.endAngle);return function(a){r.startAngle=e(a);r.endAngle=i(a);return t.arcDef(r)||""}}))})).append("text").append("tspan").data(t.arcs,(function(t){return t})).text((function(t){return t.data.name}))}),(function(r){return r.call((function(r){return r.transition().duration(t.transitionDuration||f.transitionDuration).ease(l).attr("fill",(function(r){return r.data.colour||r.data.color||t.colourScale(r.data.name)})).attrTween("d",(function(r){var a=t.prevArcs.filter((function(t){return t.data.name===r.data.name}))[0]||r;var e=g(a.startAngle,r.startAngle);var i=g(a.endAngle,r.endAngle);return function(a){r.startAngle=e(a);r.endAngle=i(a);return t.arcDef(r)||""}}))}))}),(function(t){return t.call((function(t){return t.remove()}))}))};t.prototype.render=function(){return a("div",{class:"donut-container",style:{minWidth:(this.width||f.width)+"px"}},a("div",{class:"donut-image-container"},a("svg",{class:"svg-content"+(this.data&&this.data.length?"":" no-data"),width:this.width||f.width,height:this.height,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 "+(this.width||f.width)+" "+(this.height||f.height),preserveAspectRatio:"xMinYMin meet"})))};Object.defineProperty(t.prototype,"hostEl",{get:function(){return e(this)},enumerable:true,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{data:["setDataHandler"]}},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return":host{--epi-donut-background-color:var(--epi2me-background-color,transparent)}.donut-container{-ms-flex-flow:row wrap;flex-flow:row wrap;width:-webkit-min-content;width:-moz-min-content;width:min-content;-ms-flex:0 1 auto;flex:0 1 auto;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;margin:0 auto}.donut-container,.donut-container .donut-image-container{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.donut-container .donut-image-container{-ms-flex-line-pack:center;align-content:center;-ms-flex:0 1 auto;flex:0 1 auto;-ms-flex-flow:row wrap;flex-flow:row wrap}.donut-container .donut-image-container .svg-content.no-data{display:none}"},enumerable:true,configurable:true});return t}())}}}));