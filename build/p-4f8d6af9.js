import{c as r,a as t}from"./p-a5a6d918.js";var e=r((function(r){r.exports=function(){var r={precision:2,roundMode:"up",scale:"SI",unit:"",recursive:0},t=Object.keys(r),e={SI:i({y:1e-24,z:1e-21,a:1e-18,f:1e-15,p:1e-12,n:1e-9,"µ":1e-6,m:.001,"":1,k:1e3,M:1e6,G:1e9,T:1e12,P:1e15,E:1e18,Z:1e21,Y:1e24},1),time:i({ns:1e-9,ms:.001,s:1,m:60,h:3600,d:86400},1),IEEE1541:i({"":1,Ki:1e3,Mi:1e6,Gi:1e9,Ti:1e12,Pi:1e15,Ei:1e18,Zi:1e21,Yi:1e24},0)};function n(e){var n,i;for(e=e||{},n=0,i=t.length;n<i;++n)t[n]in e||(e[t[n]]=r[t[n]]);return e}function i(r,t){var e,n,i=[],u={},a=Number.MAX_VALUE,s=[];return t=t||0,Object.keys(r).forEach((function(e){var o=e,c=r[e];i.push([o,c]),u[o]=c,s.push(o.replace(/([.*+?=^!:${}()|[\]\/\\])/g,"\\$1")),Math.abs(t-c)<Math.abs(t-a)&&(n=o,a=c)})),i.sort((function(r,t){return r[1]-t[1]})),s=s.sort((function(r,t){return t.length-r.length})).join("|"),e=new RegExp("^\\s*((?:-)?\\d+(?:\\.\\d+)?)\\s*("+s+").*?$","i"),{list:i,map:u,re:e,base:n}}function u(r,t){var i,a,s,o,c,f;return t=n(t),c=Number(r),a=e[t.scale],c?(i=c<0,c=Math.abs(c),s=function(r,t){for(var e,n=0,i=r.length-1;n!==i;)r[e=n+i+1>>1][1]>t?i=e-1:n=e;return r[n]}(a.list,c),o=+("1e"+Math.max(t.precision,0)),c=function(r,t,e){var n=0|e;return t&&(n=-n,e=-e),e="even"===r?!t&&n>e||1&n?n+1:n:"odd"===r?!t&&n>e||1&n?n:n+1:"up"===r?Math.ceil(e):"down"===r?Math.floor(e):Math.round(e),t?Math.abs(e):e}(t.roundMode,i,c*o/s[1])/o,t.recursive?(--t.recursive,c|=0,f=Math.abs(r)-c*s[1],c=String(c)):c=function(r,t){return(0|r)!==r&&Math.max(t,0)?Number(r).toFixed(t):String(r)}(c,t.precision),i&&("0"!==c&&(c="-"+c),f=-f),c=c+s[0]+t.unit,f&&s!==a.list[0]&&(f=u(f,t),c=Array.isArray(f)?[c].concat(f):[c,f]),c):"0"+a.base+t.unit}return e["IEEE-1541"]=e.IEEE1541,Object.defineProperties(u,{options:{configurable:!1,enumerable:!0,writable:!1,value:{default:r}},scales:{configurable:!1,enumerable:!0,writable:!1,value:Object.keys(e).reduce((function(r,t){return r[t]=t,r}),{})},defineScale:{configurable:!1,enumerable:!0,writable:!1,value:function(r,t,n){e[r]=i(t,n),u.scales[r]=r}},parse:{configurable:!1,enumerable:!0,writable:!1,value:function r(t,i){var u,a;return Array.isArray(t)?t.reduce((function(t,e){return t+r(e,i)}),0):(i=n(i),u=e[i.scale],(a=String(t).match(u.re))?(a[2]||(a[2]=u.base),t=a[1]*u.map[a[2]]):t=NaN,t)}}}),u}()}));function n(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function i(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function u(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?i(Object(e),!0).forEach((function(t){n(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}function a(r){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}function s(r,t){return(s=Object.setPrototypeOf||function(r,t){return r.__proto__=t,r})(r,t)}function o(r,t,e){return(o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(j){return!1}}()?Reflect.construct:function(r,t,e){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(r,n));return e&&s(i,e.prototype),i}).apply(null,arguments)}function c(r){var t="function"==typeof Map?new Map:void 0;return(c=function(r){if(null===r||-1===Function.toString.call(r).indexOf("[native code]"))return r;if("function"!=typeof r)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(r))return t.get(r);t.set(r,e)}function e(){return o(r,arguments,a(this).constructor)}return e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),s(e,r)})(r)}var f=Object.prototype.toString,h=function(r){if(void 0===r)return"undefined";if(null===r)return"null";var t=typeof r;if("boolean"===t)return"boolean";if("string"===t)return"string";if("number"===t)return"number";if("symbol"===t)return"symbol";if("function"===t)return"GeneratorFunction"===l(r)?"generatorfunction":"function";if(function(r){return Array.isArray?Array.isArray(r):r instanceof Array}(r))return"array";if(function(r){return!(!r.constructor||"function"!=typeof r.constructor.isBuffer)&&r.constructor.isBuffer(r)}(r))return"buffer";if(function(r){try{if("number"==typeof r.length&&"function"==typeof r.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(r))return"arguments";if(function(r){return r instanceof Date||"function"==typeof r.toDateString&&"function"==typeof r.getDate&&"function"==typeof r.setDate}(r))return"date";if(function(r){return r instanceof Error||"string"==typeof r.message&&r.constructor&&"number"==typeof r.constructor.stackTraceLimit}(r))return"error";if(function(r){return r instanceof RegExp||"string"==typeof r.flags&&"boolean"==typeof r.ignoreCase&&"boolean"==typeof r.multiline&&"boolean"==typeof r.global}(r))return"regexp";switch(l(r)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(r){return"function"==typeof r.throw&&"function"==typeof r.return&&"function"==typeof r.next}(r))return"generator";switch(t=f.call(r)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")};function l(r){return r.constructor?r.constructor.name:null}var v={any:function(r){return void 0!==r},arguments:function(r){return"arguments"===h(r)},array:function(r){return"array"===h(r)},boolean:function(r){return"boolean"===h(r)},buffer:function(r){return"buffer"===h(r)},date:function(r){return"date"===h(r)&&!isNaN(r)},error:function(r){return"error"===h(r)},float32array:function(r){return"float32array"===h(r)},float64array:function(r){return"float64array"===h(r)},function:function(r){return"function"===h(r)},generatorfunction:function(r){return"generatorfunction"===h(r)},int16array:function(r){return"int16array"===h(r)},int32array:function(r){return"int32array"===h(r)},int8array:function(r){return"int8array"===h(r)},map:function(r){return"map"===h(r)},null:function(r){return"null"===h(r)},number:function(r){return"number"===h(r)},object:function(r){return"object"===h(r)},promise:function(r){return"promise"===h(r)},regexp:function(r){return"regexp"===h(r)},set:function(r){return"set"===h(r)},string:function(r){return"string"===h(r)},symbol:function(r){return"symbol"===h(r)},uint16array:function(r){return"uint16array"===h(r)},uint32array:function(r){return"uint32array"===h(r)},uint8array:function(r){return"uint8array"===h(r)},uint8clampedarray:function(r){return"uint8clampedarray"===h(r)},undefined:function(r){return"undefined"===h(r)},weakmap:function(r){return"weakmap"===h(r)},weakset:function(r){return"weakset"===h(r)}},y="Invariant failed";function p(r){if(!r)throw new Error(y)}var d=function(r){var t,e;function n(t){var e;p(t.length>0);var i=t[0],u=i.path,a=i.value,s=i.type,o=i.branch,c=function(r,t){if(null==r)return{};var e,n,i={},u=Object.keys(r);for(n=0;n<u.length;n++)t.indexOf(e=u[n])>=0||(i[e]=r[e]);return i}(i,["path","value","type","branch"]),f="Expected a value of type `"+s+"`"+(u.length?" for `"+u.join(".")+"`":"")+" but received `"+JSON.stringify(a)+"`.";return(e=r.call(this,f)||this).type=s,e.value=a,Object.assign(function(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}(e),c),e.path=u,e.branch=o,e.failures=t,e.stack=(new Error).stack,e.__proto__=n.prototype,e}return e=r,(t=n).prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e,n}(c(TypeError)),b=Symbol("STRUCT"),m=function(r){var t=r.struct.Error,e=function r(t){return r.assert(t)};return Object.defineProperty(e,b,{value:!0}),e.kind=r.kind,e.type=r.type,e.default=function(){return"function"==typeof r.defaults?r.defaults():r.defaults},e.test=function(r){return!e.check(r,[r],[])[0]},e.assert=function(r){var n=e.check(r,[r],[]),i=n[0],u=n[1];if(i)throw new t(i);return u},e.validate=function(r){var n=e.check(r,[r],[]),i=n[0],u=n[1];return i?[new t(i)]:[void 0,u]},e.check=function(r,t,n){return void 0===r&&(r=e.default()),[[e.fail({value:r,branch:t,path:n})]]},e.fail=function(r){return u({},r,{type:"type"in r?r.type:e.type})},e},_=function(r,t,e){p(Array.isArray(r)&&0!==r.length);var n=r.map((function(r){return e(r)})),i=n.map((function(r){return r.type})).join(" | "),u=m({kind:"union",type:i,defaults:t,struct:e});return u.check=function(r,t,e){void 0===r&&(r=u.default());var i=n,a=Array.isArray(i),s=0;for(i=a?i:i[Symbol.iterator]();;){var o;if(a){if(s>=i.length)break;o=i[s++]}else{if((s=i.next()).done)break;o=s.value}var c=o.check(r,t,e);if(!c[0])return[void 0,c[1]]}return[[u.fail({value:r,branch:t,path:e})]]},u},w=function(r){void 0===r&&(r={});var t=function r(t,e){return function(r,t,e){if("function"==typeof(n=r)&&n[b])return r;var n;if(Array.isArray(r)){if(1===r.length)return e.array([r[0]],t);if(r.length>1)return e.tuple(r,t)}if("function"==typeof r)return e.function(r,t);if("object"==typeof r)return e.object(r,t);if("string"==typeof r){var i,u=!1;if(r.endsWith("?")&&(u=!0,r=r.slice(0,-1)),r.includes("|")){var a=r.split(/\s*\|\s*/g);i=e.union(a,t)}else if(r.includes("&")){var s=r.split(/\s*&\s*/g);i=e.intersection(s,t)}else i=e.scalar(r,t);return u&&(i=e.union([i,"undefined"],void 0)),i}throw new Error("A schema definition must be an object, array, string or function, but you passed: "+r)}(t,e,r)};return t.array=function(r,e){return function(r,t,e){p(Array.isArray(r)&&1===r.length);var n=e(r[0],void 0),i=m({kind:"array",type:n.type+"[]",defaults:t,struct:e});return i.check=function(r,t,e){if(void 0===r&&(r=i.default()),!Array.isArray(r))return[[i.fail({value:r,branch:t,path:e})]];for(var u=[],a=[],s=0;s<r.length;s++){var o=r[s],c=n.check(o,t.concat(o),e.concat(s)),f=c[0],h=c[1];f?a.push.apply(a,f):u[s]=h}return a.length?[a]:[void 0,u]},i}(r,e,t)},t.dynamic=function(r,e){return function(r,t,e){p("function"==typeof r);var n=m({kind:"dynamic",type:"dynamic<…>",defaults:t,struct:e});return n.check=function(t,e,i){return void 0===t&&(t=n.default()),r(t,e,i).check(t,e,i)},n}(r,e,t)},t.enum=function(r,e){return function(r,t,e){p(Array.isArray(r));var n=e((function(t){return r.includes(t)}),t);return n.kind="enum",n.type=r.map((function(r){return"string"==typeof r?'"'+r+'"':""+r})).join(" | "),n}(r,e,t)},t.function=function(r,e){return function(r,t,e){var n=m({kind:"function",type:"function<…>",defaults:t,struct:e});return n.check=function(t,e,i){void 0===t&&(t=n.default());var a=r(t,e,i);if(!0===a)return[void 0,t];var s=[];if(!1===a)s.push(n.fail({value:t,branch:e,path:i}));else if(Array.isArray(a)&&a.length>0){var o=a,c=Array.isArray(o),f=0;for(o=c?o:o[Symbol.iterator]();;){var h;if(c){if(f>=o.length)break;h=o[f++]}else{if((f=o.next()).done)break;h=f.value}s.push(n.fail(u({value:t,branch:e,path:i},h)))}}else"object"==typeof a?s.push(n.fail(u({value:t,branch:e,path:i},a))):p(!1);return[s]},n}(r,e,t)},t.instance=function(r,e){return function(r,t,e){p("function"==typeof r);var n=e((function(t){return t instanceof r}),t);return n.kind="instance",n.type="instance<"+r.name+">",n}(r,e,t)},t.interface=function(r,e){return function(r,t,e){p("object"==typeof r);var n={};for(var i in r)n[i]=e(r[i]);var u=m({kind:"interface",type:"interface<{"+Object.keys(r).join()+"}>",defaults:t,struct:e});return u.check=function(r,t,e){if(void 0===r&&(r=u.default()),"object"!=typeof r&&"function"!=typeof r)return[[u.fail({value:r,branch:t,path:e})]];var i=[];for(var a in n){var s=r[a],o=n[a].check(s,t.concat(s),e.concat(a))[0];o&&i.push.apply(i,o)}return i.length?[i]:[void 0,r]},u}(r,e,t)},t.intersection=function(r,e){return function(r,t,e){p(Array.isArray(r)&&0!==r.length);var n=r.map((function(r){return e(r)})),i=n.map((function(r){return r.type})).join(" & "),u=m({kind:"intersection",type:i,defaults:t,struct:e});return u.check=function(r,t,e){void 0===r&&(r=u.default());var i=r,a=n,s=Array.isArray(a),o=0;for(a=s?a:a[Symbol.iterator]();;){var c;if(s){if(o>=a.length)break;c=a[o++]}else{if((o=a.next()).done)break;c=o.value}var f=c.check(r,t,e),h=f[1];if(f[0])return[[u.fail({value:r,branch:t,path:e})]];i=h}return[void 0,i]},u}(r,e,t)},t.lazy=function(r,e){return function(r,t,e){p("function"==typeof r);var n=m({kind:"lazy",type:"lazy<…>",defaults:t,struct:e});return n.check=function(){return Object.assign(n,r()),n.check.apply(n,arguments)},n}(r,e,t)},t.literal=function(r,e){return function(r,t,e){var n=e((function(t){return t===r}),t);return n.kind="literal",n.type="string"==typeof r?'"'+r+'"':""+r,n}(r,e,t)},t.object=function(r,e){return function(r,t,e){p("object"==typeof r);var n={};for(var i in r)n[i]=e(r[i]);var u=m({kind:"object",type:"{"+Object.keys(r).join()+"}",defaults:t,struct:e});return u.check=function(r,t,e){void 0===r&&(r=u.default());var i=u.default();if(void 0===r&&(r=i),"object"!==h(r))return[[u.fail({value:r,branch:t,path:e})]];var a={},s=[],o=new Set(Object.keys(n).concat(Object.keys(r))),c=Array.isArray(o),f=0;for(o=c?o:o[Symbol.iterator]();;){var l;if(c){if(f>=o.length)break;l=o[f++]}else{if((f=o.next()).done)break;l=f.value}var v=l,y=r[v],p=e.concat(v),d=t.concat(y),b=n[v];if(void 0===y&&null!=i&&v in i&&(y="function"==typeof i[v]?i[v](r,t,e):i[v]),v in n){var m=b.check(y,d,p),_=m[0],w=m[1];_?s.push.apply(s,_):void 0!==w&&v in n&&(a[v]=w)}else s.push(u.fail({type:void 0,value:y,path:p,branch:r}))}return s.length?[s]:[void 0,a]},u}(r,e,t)},t.optional=function(r,e){return _([r,"undefined"],e,t)},t.partial=function(r,e){return function(r,t,e){p("object"==typeof r);var n={};for(var i in r)n[i]=e.union([r[i],"undefined"]);var u=m({kind:"object",type:"{"+Object.keys(r).join()+"}",defaults:t,struct:e});return u.check=function(r,t,e){void 0===r&&(r=u.default());var i=u.default();if(void 0===r&&(r=i),"object"!==h(r))return[[u.fail({value:r,branch:t,path:e})]];var a={},s=[],o=r,c=Array.isArray(o),f=0;for(o=c?o:o[Symbol.iterator]();;){var l;if(c){if(f>=o.length)break;l=o[f++]}else{if((f=o.next()).done)break;l=f.value}var v=l,y=r[v],p=e.concat(v),d=t.concat(y),b=n[v];if(void 0===y&&null!=i&&v in i&&(y="function"==typeof i[v]?i[v](r,t,e):i[v]),v in n){var m=b.check(y,d,p),_=m[0],w=m[1];_?s.push.apply(s,_):void 0!==w&&v in n&&(a[v]=w)}else s.push(u.fail({type:void 0,value:y,path:p,branch:r}))}return s.length?[s]:[void 0,a]},u}(r,e,t)},t.pick=function(r,e){return function(r,t,e){p("object"==typeof r);var n={};for(var i in r)n[i]=e(r[i]);var u=m({kind:"pick",type:"pick<{"+Object.keys(r).join()+"}>",defaults:t,struct:e});return u.check=function(r,t,e){void 0===r&&(r=u.default());var i=u.default();if(void 0===r&&(r=i),"object"!==h(r))return[[u.fail({value:r,branch:t,path:e})]];var a={},s=[];for(var o in n){var c=r[o],f=e.concat(o),l=t.concat(c),v=n[o];void 0===c&&null!=i&&o in i&&(c="function"==typeof i[o]?i[o](r,t,e):i[o]);var y=v.check(c,l,f),p=y[0],d=y[1];p?s.push.apply(s,p):void 0!==d&&o in n&&(a[o]=d)}return s.length?[s]:[void 0,a]},u}(r,e,t)},t.record=function(r,e){return function(r,t,e){p(Array.isArray(r)&&2===r.length);var n=e(r[0]),i=e(r[1]),a=m({kind:"record",type:"record<"+n.type+","+i.type+">",defaults:t,struct:e});return a.check=function(r,t,e){var s=a.default();if(r=s?u({},s,{},r):r,"object"!==h(r))return[[a.fail({value:r,branch:t,path:e})]];var o={},c=[];for(var f in r){var l=r[f],v=e.concat(f),y=t.concat(l),p=n.check(f,y,v),d=p[0],b=p[1];if(d)c.push.apply(c,d);else{var m=i.check(l,y,v),_=m[0],w=m[1];_?c.push.apply(c,_):o[b]=w}}return c.length?[c]:[void 0,o]},a}(r,e,t)},t.scalar=function(r,e){return function(r,t,e){p("string"==typeof r);var n=e.Types;p(r in n);var i=e(n[r],t);return i.kind="scalar",i.type=r,i}(r,e,t)},t.size=function(r,e){return function(r,t,e){p(Array.isArray(r)&&2===r.length&&r.every((function(r){return"number"==typeof r})));var n=r[0],i=r[1],u=e((function(r){return null!=r&&"number"==typeof r.length&&r.length>=n&&r.length<=i}),t);return u.kind="size",u.type="size<"+n+","+i+">",u}(r,e,t)},t.tuple=function(r,e){return function(r,t,e){p(Array.isArray(r));var n=r.map((function(r){return e(r)})),i=m({kind:"tuple",type:"["+n.map((function(r){return r.type})).join()+"]",defaults:t,struct:e});return i.check=function(r,t,e){if(void 0===r&&(r=i.default()),!Array.isArray(r))return[[i.fail({value:r,branch:t,path:e})]];for(var u=[],a=[],s=Math.max(r.length,n.length),o=0;o<s;o++){var c=n[o],f=r[o],h=e.concat(o),l=t.concat(f);if(c){var v=c.check(f,l,h),y=v[0],p=v[1];y?a.push.apply(a,y):u[o]=p}else a.push(i.fail({type:void 0,value:f,path:h,branch:l}))}return a.length?[a]:[void 0,u]},i}(r,e,t)},t.union=function(r,e){return _(r,e,t)},t.Error=r.error||d,t.Types=u({},v,{},r.types),t}();const g=(j=(r,t)=>{function e(r){return null!==r&&"[object Array]"===Object.prototype.toString.call(r)}function n(r){return null!==r&&"[object Object]"===Object.prototype.toString.call(r)}function i(r,t){if(r===t)return!0;if(Object.prototype.toString.call(r)!==Object.prototype.toString.call(t))return!1;if(!0===e(r)){if(r.length!==t.length)return!1;for(var u=0;u<r.length;u++)if(!1===i(r[u],t[u]))return!1;return!0}if(!0===n(r)){var a={};for(var s in r)if(Object.hasOwnProperty.call(r,s)){if(!1===i(r[s],t[s]))return!1;a[s]=!0}for(var o in t)if(Object.hasOwnProperty.call(t,o)&&!0!==a[o])return!1;return!0}return!1}function u(r){if(""===r||!1===r||null==r)return!0;if(e(r)&&0===r.length)return!0;if(n(r)){for(var t in r)if(r.hasOwnProperty(t))return!1;return!0}return!1}var a;a="function"==typeof String.prototype.trimLeft?function(r){return r.trimLeft()}:function(r){const t=r.match(/^\s*(.*)/);return t&&t[1]};const s={0:"NUMBER",1:"ANY",2:"STRING",3:"ARRAY",4:"OBJECT",5:"BOOLEAN",6:"EXPREF",7:"NULL",8:"ARRAY_NUMBER",9:"ARRAY_STRING"};var o=0,c=1,f=2,h=3,l=4,v=5,y=6,p=7,d=8,b=9,m="EOF",_="UnquotedIdentifier",w="QuotedIdentifier",g="Rbracket",j="Rparen",E="Comma",k="Colon",O="Rbrace",A="Number",S="Current",x="Expref",M="Pipe",N="Or",I="And",P="EQ",R="GT",T="LT",F="GTE",L="LTE",$="NE",U="Flatten",B="Star",C="Filter",z="Dot",G="Not",J="Lbrace",D="Lbracket",Y="Lparen",H="Literal",V={".":z,"*":B,",":E,":":k,"{":J,"}":O,"]":g,"(":Y,")":j,"@":S},W={"<":!0,">":!0,"=":!0,"!":!0},Z={" ":!0,"\t":!0,"\n":!0};function K(r){return r>="0"&&r<="9"||"-"===r}class Q{constructor(){this._current=0}tokenize(r){for(var t,e,n,i,u=[];this._current<r.length;)if((i=r[this._current])>="a"&&i<="z"||i>="A"&&i<="Z"||"_"===i||"$"===i)t=this._current,e=this._consumeUnquotedIdentifier(r),u.push({type:_,value:e,start:t});else if(void 0!==V[r[this._current]])u.push({type:V[r[this._current]],value:r[this._current],start:this._current}),this._current++;else if(K(r[this._current]))n=this._consumeNumber(r),u.push(n);else if("["===r[this._current])n=this._consumeLBracket(r),u.push(n);else if('"'===r[this._current])t=this._current,e=this._consumeQuotedIdentifier(r),u.push({type:w,value:e,start:t});else if("'"===r[this._current])t=this._current,e=this._consumeRawStringLiteral(r),u.push({type:H,value:e,start:t});else if("`"===r[this._current]){t=this._current;var a=this._consumeLiteral(r);u.push({type:H,value:a,start:t})}else if(void 0!==W[r[this._current]])u.push(this._consumeOperator(r));else if(void 0!==Z[r[this._current]])this._current++;else if("&"===r[this._current])t=this._current,this._current++,"&"===r[this._current]?(this._current++,u.push({type:I,value:"&&",start:t})):u.push({type:x,value:"&",start:t});else{if("|"!==r[this._current]){var s=new Error("Unknown character:"+r[this._current]);throw s.name="LexerError",s}t=this._current,this._current++,"|"===r[this._current]?(this._current++,u.push({type:N,value:"||",start:t})):u.push({type:M,value:"|",start:t})}return u}_consumeUnquotedIdentifier(r){var t,e=this._current;for(this._current++;this._current<r.length&&((t=r[this._current])>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||"_"===t||"$"===t);)this._current++;return r.slice(e,this._current)}_consumeQuotedIdentifier(r){var t=this._current;this._current++;for(var e=r.length;'"'!==r[this._current]&&this._current<e;){var n=this._current;"\\"!==r[n]||"\\"!==r[n+1]&&'"'!==r[n+1]?n++:n+=2,this._current=n}return this._current++,JSON.parse(r.slice(t,this._current))}_consumeRawStringLiteral(r){var t=this._current;this._current++;for(var e=r.length;"'"!==r[this._current]&&this._current<e;){var n=this._current;"\\"!==r[n]||"\\"!==r[n+1]&&"'"!==r[n+1]?n++:n+=2,this._current=n}return this._current++,r.slice(t+1,this._current-1).replace("\\'","'")}_consumeNumber(r){var t=this._current;this._current++;for(var e=r.length;K(r[this._current])&&this._current<e;)this._current++;var n=parseInt(r.slice(t,this._current));return{type:A,value:n,start:t}}_consumeLBracket(r){var t=this._current;return this._current++,"?"===r[this._current]?(this._current++,{type:C,value:"[?",start:t}):"]"===r[this._current]?(this._current++,{type:U,value:"[]",start:t}):{type:D,value:"[",start:t}}_consumeOperator(r){var t=this._current,e=r[t];return this._current++,"!"===e?"="===r[this._current]?(this._current++,{type:$,value:"!=",start:t}):{type:G,value:"!",start:t}:"<"===e?"="===r[this._current]?(this._current++,{type:L,value:"<=",start:t}):{type:T,value:"<",start:t}:">"===e?"="===r[this._current]?(this._current++,{type:F,value:">=",start:t}):{type:R,value:">",start:t}:"="===e&&"="===r[this._current]?(this._current++,{type:P,value:"==",start:t}):void 0}_consumeLiteral(r){this._current++;for(var t,e=this._current,n=r.length;"`"!==r[this._current]&&this._current<n;){var i=this._current;"\\"!==r[i]||"\\"!==r[i+1]&&"`"!==r[i+1]?i++:i+=2,this._current=i}var u=a(r.slice(e,this._current));return u=u.replace("\\`","`"),t=this._looksLikeJSON(u)?JSON.parse(u):JSON.parse('"'+u+'"'),this._current++,t}_looksLikeJSON(r){if(""===r)return!1;if('[{"'.indexOf(r[0])>=0)return!0;if(["true","false","null"].indexOf(r)>=0)return!0;if(!("-0123456789".indexOf(r[0])>=0))return!1;try{return JSON.parse(r),!0}catch(t){return!1}}}var q={};q[m]=0,q[_]=0,q[w]=0,q[g]=0,q[j]=0,q[E]=0,q[O]=0,q[A]=0,q[S]=0,q[x]=0,q[M]=1,q[N]=2,q[I]=3,q[P]=5,q[R]=5,q[T]=5,q[F]=5,q[L]=5,q[$]=5,q[U]=9,q[B]=20,q[C]=21,q[z]=40,q[G]=45,q[J]=50,q[D]=55,q[Y]=60;class X{constructor(){this.index=0,this.tokens=[]}parse(r){this._loadTokens(r),this.index=0;var t=this.expression(0);if(this._lookahead(0)!==m){var e=this._lookaheadToken(0),n=new Error("Unexpected token type: "+e.type+", value: "+e.value);throw n.name="ParserError",n}return t}_loadTokens(r){var t=(new Q).tokenize(r);t.push({type:m,value:"",start:r.length}),this.tokens=t}expression(r){var t=this._lookaheadToken(0);this._advance();for(var e=this.nud(t),n=this._lookahead(0);r<q[n];)this._advance(),e=this.led(n,e),n=this._lookahead(0);return e}_lookahead(r){return this.tokens[this.index+r].type}_lookaheadToken(r){return this.tokens[this.index+r]}_advance(){this.index++}nud(r){var t,e;switch(r.type){case H:return{type:"Literal",value:r.value};case _:return{type:"Field",name:r.value};case w:var n={type:"Field",name:r.value};if(this._lookahead(0)===Y)throw new Error("Quoted identifier not allowed for function names.");return n;case G:return{type:"NotExpression",children:[t=this.expression(q.Not)]};case B:return t=null,{type:"ValueProjection",children:[{type:"Identity"},t=this._lookahead(0)===g?{type:"Identity"}:this._parseProjectionRHS(q.Star)]};case C:return this.led(r.type,{type:"Identity"});case J:return this._parseMultiselectHash();case U:return{type:"Projection",children:[{type:U,children:[{type:"Identity"}]},t=this._parseProjectionRHS(q.Flatten)]};case D:return this._lookahead(0)===A||this._lookahead(0)===k?(t=this._parseIndexExpression(),this._projectIfSlice({type:"Identity"},t)):this._lookahead(0)===B&&this._lookahead(1)===g?(this._advance(),this._advance(),{type:"Projection",children:[{type:"Identity"},t=this._parseProjectionRHS(q.Star)]}):this._parseMultiselectList();case S:return{type:S};case x:return{type:"ExpressionReference",children:[e=this.expression(q.Expref)]};case Y:for(var i=[];this._lookahead(0)!==j;)this._lookahead(0)===S?(e={type:S},this._advance()):e=this.expression(0),i.push(e);return this._match(j),i[0];default:this._errorToken(r)}}led(r,t){var e;switch(r){case z:var n=q.Dot;return this._lookahead(0)!==B?{type:"Subexpression",children:[t,e=this._parseDotRHS(n)]}:(this._advance(),{type:"ValueProjection",children:[t,e=this._parseProjectionRHS(n)]});case M:return e=this.expression(q.Pipe),{type:M,children:[t,e]};case N:return{type:"OrExpression",children:[t,e=this.expression(q.Or)]};case I:return{type:"AndExpression",children:[t,e=this.expression(q.And)]};case Y:for(var i,u=t.name,a=[];this._lookahead(0)!==j;)this._lookahead(0)===S?(i={type:S},this._advance()):i=this.expression(0),this._lookahead(0)===E&&this._match(E),a.push(i);return this._match(j),{type:"Function",name:u,children:a};case C:var s=this.expression(0);return this._match(g),{type:"FilterProjection",children:[t,e=this._lookahead(0)===U?{type:"Identity"}:this._parseProjectionRHS(q.Filter),s]};case U:return{type:"Projection",children:[{type:U,children:[t]},this._parseProjectionRHS(q.Flatten)]};case P:case $:case R:case F:case T:case L:return this._parseComparator(t,r);case D:var o=this._lookaheadToken(0);return o.type===A||o.type===k?(e=this._parseIndexExpression(),this._projectIfSlice(t,e)):(this._match(B),this._match(g),{type:"Projection",children:[t,e=this._parseProjectionRHS(q.Star)]});default:this._errorToken(this._lookaheadToken(0))}}_match(r){if(this._lookahead(0)!==r){var t=this._lookaheadToken(0),e=new Error("Expected "+r+", got: "+t.type);throw e.name="ParserError",e}this._advance()}_errorToken(r){var t=new Error("Invalid token ("+r.type+'): "'+r.value+'"');throw t.name="ParserError",t}_parseIndexExpression(){if(this._lookahead(0)===k||this._lookahead(1)===k)return this._parseSliceExpression();var r={type:"Index",value:this._lookaheadToken(0).value};return this._advance(),this._match(g),r}_projectIfSlice(r,t){var e={type:"IndexExpression",children:[r,t]};return"Slice"===t.type?{type:"Projection",children:[e,this._parseProjectionRHS(q.Star)]}:e}_parseSliceExpression(){for(var r=[null,null,null],t=0,e=this._lookahead(0);e!==g&&t<3;){if(e===k)t++,this._advance();else{if(e!==A){var n=this._lookahead(0),i=new Error("Syntax error, unexpected token: "+n.value+"("+n.type+")");throw i.name="Parsererror",i}r[t]=this._lookaheadToken(0).value,this._advance()}e=this._lookahead(0)}return this._match(g),{type:"Slice",children:r}}_parseComparator(r,t){return{type:"Comparator",name:t,children:[r,this.expression(q[t])]}}_parseDotRHS(r){var t=this._lookahead(0);return[_,w,B].indexOf(t)>=0?this.expression(r):t===D?(this._match(D),this._parseMultiselectList()):t===J?(this._match(J),this._parseMultiselectHash()):void 0}_parseProjectionRHS(r){var t;if(q[this._lookahead(0)]<10)t={type:"Identity"};else if(this._lookahead(0)===D)t=this.expression(r);else if(this._lookahead(0)===C)t=this.expression(r);else{if(this._lookahead(0)!==z){var e=this._lookaheadToken(0),n=new Error("Sytanx error, unexpected token: "+e.value+"("+e.type+")");throw n.name="ParserError",n}this._match(z),t=this._parseDotRHS(r)}return t}_parseMultiselectList(){for(var r=[];this._lookahead(0)!==g;){var t=this.expression(0);if(r.push(t),this._lookahead(0)===E&&(this._match(E),this._lookahead(0)===g))throw new Error("Unexpected token Rbracket")}return this._match(g),{type:"MultiSelectList",children:r}}_parseMultiselectHash(){for(var r,t,e,n=[],i=[_,w];;){if(r=this._lookaheadToken(0),i.indexOf(r.type)<0)throw new Error("Expecting an identifier token, got: "+r.type);if(t=r.value,this._advance(),this._match(k),e=this.expression(0),n.push({type:"KeyValuePair",name:t,value:e}),this._lookahead(0)===E)this._match(E);else if(this._lookahead(0)===O){this._match(O);break}}return{type:"MultiSelectHash",children:n}}}class rr{constructor(r){this.runtime=r}search(r,t){return this.visit(r,t)}visit(r,t){var a,s,o,c,f,h,l,v,y;switch(r.type){case"Field":return null===t?null:n(t)?void 0===(h=t[r.name])?null:h:null;case"Subexpression":for(o=this.visit(r.children[0],t),y=1;y<r.children.length;y++)if(null===(o=this.visit(r.children[1],o)))return null;return o;case"IndexExpression":return l=this.visit(r.children[0],t),this.visit(r.children[1],l);case"Index":if(!e(t))return null;var p=r.value;return p<0&&(p=t.length+p),void 0===(o=t[p])&&(o=null),o;case"Slice":if(!e(t))return null;var d=r.children.slice(0),b=this.computeSliceParams(t.length,d),m=b[0],_=b[1],w=b[2];if(o=[],null===m||null===_||null===w)return;if(w>0)for(y=m;y<_;y+=w)o.push(t[y]);else for(y=m;y>_;y+=w)o.push(t[y]);return o;case"Projection":var g=this.visit(r.children[0],t);if(!e(g))return null;for(v=[],y=0;y<g.length;y++)null!==(s=this.visit(r.children[1],g[y]))&&v.push(s);return v;case"ValueProjection":if(!n(g=this.visit(r.children[0],t)))return null;v=[];var j=function(r){for(var t=Object.keys(r),e=[],n=0;n<t.length;n++)e.push(r[t[n]]);return e}(g);for(y=0;y<j.length;y++)null!==(s=this.visit(r.children[1],j[y]))&&v.push(s);return v;case"FilterProjection":if(!e(g=this.visit(r.children[0],t)))return null;var E=[],k=[];for(y=0;y<g.length;y++)u(a=this.visit(r.children[2],g[y]))||E.push(g[y]);for(var O=0;O<E.length;O++)null!==(s=this.visit(r.children[1],E[O]))&&k.push(s);return k;case"Comparator":switch(c=this.visit(r.children[0],t),f=this.visit(r.children[1],t),r.name){case P:o=i(c,f);break;case $:o=!i(c,f);break;case R:o=c>f;break;case F:o=c>=f;break;case T:o=c<f;break;case L:o=c<=f;break;default:throw new Error("Unknown comparator: "+r.name)}return o;case U:var A=this.visit(r.children[0],t);if(!e(A))return null;var N=[];for(y=0;y<A.length;y++)e(s=A[y])?N.push.apply(N,s):N.push(s);return N;case"Identity":return t;case"MultiSelectList":if(null===t)return null;for(v=[],y=0;y<r.children.length;y++)v.push(this.visit(r.children[y],t));return v;case"MultiSelectHash":if(null===t)return null;var I;for(v={},y=0;y<r.children.length;y++)v[(I=r.children[y]).name]=this.visit(I.value,t);return v;case"OrExpression":return u(a=this.visit(r.children[0],t))&&(a=this.visit(r.children[1],t)),a;case"AndExpression":return!0===u(c=this.visit(r.children[0],t))?c:this.visit(r.children[1],t);case"NotExpression":return u(c=this.visit(r.children[0],t));case"Literal":return r.value;case M:return l=this.visit(r.children[0],t),this.visit(r.children[1],l);case S:return t;case"Function":var B=[];for(y=0;y<r.children.length;y++)B.push(this.visit(r.children[y],t));return this.runtime.callFunction(r.name,B);case"ExpressionReference":var C=r.children[0];return C.jmespathType=x,C;default:throw new Error("Unknown node type: "+r.type)}}computeSliceParams(r,t){var e=t[0],n=t[1],i=t[2],u=[null,null,null];if(null===i)i=1;else if(0===i){var a=new Error("Invalid slice, step cannot be 0");throw a.name="RuntimeError",a}var s=i<0;return e=null===e?s?r-1:0:this.capSliceRange(r,e,i),n=null===n?s?-1:r:this.capSliceRange(r,n,i),u[0]=e,u[1]=n,u[2]=i,u}capSliceRange(r,t,e){return t<0?(t+=r)<0&&(t=e<0?-1:0):t>=r&&(t=e<0?r-1:r),t}}class tr{constructor(r){this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[o]}]},avg:{_func:this._functionAvg,_signature:[{types:[d]}]},ceil:{_func:this._functionCeil,_signature:[{types:[o]}]},contains:{_func:this._functionContains,_signature:[{types:[f,h]},{types:[c]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[f]},{types:[f]}]},floor:{_func:this._functionFloor,_signature:[{types:[o]}]},length:{_func:this._functionLength,_signature:[{types:[f,h,l]}]},map:{_func:this._functionMap,_signature:[{types:[y]},{types:[h]}]},max:{_func:this._functionMax,_signature:[{types:[d,b]}]},merge:{_func:this._functionMerge,_signature:[{types:[l],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[h]},{types:[y]}]},sum:{_func:this._functionSum,_signature:[{types:[d]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[f]},{types:[f]}]},min:{_func:this._functionMin,_signature:[{types:[d,b]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[h]},{types:[y]}]},type:{_func:this._functionType,_signature:[{types:[c]}]},keys:{_func:this._functionKeys,_signature:[{types:[l]}]},values:{_func:this._functionValues,_signature:[{types:[l]}]},sort:{_func:this._functionSort,_signature:[{types:[b,d]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[h]},{types:[y]}]},join:{_func:this._functionJoin,_signature:[{types:[f]},{types:[b]}]},reverse:{_func:this._functionReverse,_signature:[{types:[f,h]}]},to_array:{_func:this._functionToArray,_signature:[{types:[c]}]},to_string:{_func:this._functionToString,_signature:[{types:[c]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[c]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[c],variadic:!0}]}},this._interpreter=r}callFunction(r,t){var e=this.functionTable[r];if(void 0===e)throw new Error("Unknown function: "+r+"()");return this._validateArgs(r,t,e._signature),e._func.call(this,t)}_validateArgs(r,t,e){var n,i,u,a;if(e[e.length-1].variadic){if(t.length<e.length)throw n=1===e.length?" argument":" arguments",new Error("ArgumentError: "+r+"() takes at least"+e.length+n+" but received "+t.length)}else if(t.length!==e.length)throw n=1===e.length?" argument":" arguments",new Error("ArgumentError: "+r+"() takes "+e.length+n+" but received "+t.length);for(var o=0;o<e.length;o++){a=!1,i=e[o].types,u=this._getTypeName(t[o]);for(var c=0;c<i.length;c++)if(void 0!==u&&this._typeMatches(u,i[c],t[o])){a=!0;break}if(!a)throw new Error(`\n          TypeError: ${r}()\n            expected argument ${o+1} to be type ${i}(${s[i]}) but received type ${u}(${u&&s[u]||"UNDEFINED"}) instead.`)}}_typeMatches(r,t,e){if(t===c)return!0;if(t!==b&&t!==d&&t!==h)return r===t;if(t===h)return r===h;if(r===h){var n;t===d?n=o:t===b&&(n=f);for(var i=0;i<e.length;i++){const r=this._getTypeName(e[i]);if(void 0!==r&&void 0!==n&&!this._typeMatches(r,n,e[i]))return!1}return!0}return!1}_getTypeName(r){switch(Object.prototype.toString.call(r)){case"[object String]":return f;case"[object Number]":return o;case"[object Array]":return h;case"[object Boolean]":return v;case"[object Null]":return p;case"[object Object]":return r.jmespathType===x?y:l;default:return}}_functionStartsWith(r){return 0===r[0].lastIndexOf(r[1])}_functionEndsWith(r){var t=r[0],e=r[1];return-1!==t.indexOf(e,t.length-e.length)}_functionReverse(r){if(this._getTypeName(r[0])===f){for(var t=r[0],e="",n=t.length-1;n>=0;n--)e+=t[n];return e}var i=r[0].slice(0);return i.reverse(),i}_functionAbs(r){return Math.abs(r[0])}_functionCeil(r){return Math.ceil(r[0])}_functionAvg(r){for(var t=0,e=r[0],n=0;n<e.length;n++)t+=e[n];return t/e.length}_functionContains(r){return r[0].indexOf(r[1])>=0}_functionFloor(r){return Math.floor(r[0])}_functionLength(r){return n(r[0])?Object.keys(r[0]).length:r[0].length}_functionMap(r){if(!this._interpreter)return[];for(var t=[],e=this._interpreter,n=r[0],i=r[1],u=0;u<i.length;u++)t.push(e.visit(n,i[u]));return t}_functionMerge(r){for(var t={},e=0;e<r.length;e++){var n=r[e];for(var i in n)t[i]=n[i]}return t}_functionMax(r){if(r[0].length>0){if(this._getTypeName(r[0][0])===o)return Math.max.apply(Math,r[0]);for(var t=r[0],e=t[0],n=1;n<t.length;n++)e.localeCompare(t[n])<0&&(e=t[n]);return e}return null}_functionMin(r){if(r[0].length>0){if(this._getTypeName(r[0][0])===o)return Math.min.apply(Math,r[0]);for(var t=r[0],e=t[0],n=1;n<t.length;n++)t[n].localeCompare(e)<0&&(e=t[n]);return e}return null}_functionSum(r){for(var t=0,e=r[0],n=0;n<e.length;n++)t+=e[n];return t}_functionType(r){switch(this._getTypeName(r[0])){case o:return"number";case f:return"string";case h:return"array";case l:return"object";case v:return"boolean";case y:return"expref";case p:return"null";default:return}}_functionKeys(r){return Object.keys(r[0])}_functionValues(r){for(var t=r[0],e=Object.keys(t),n=[],i=0;i<e.length;i++)n.push(t[e[i]]);return n}_functionJoin(r){return r[1].join(r[0])}_functionToArray(r){return this._getTypeName(r[0])===h?r[0]:[r[0]]}_functionToString(r){return this._getTypeName(r[0])===f?r[0]:JSON.stringify(r[0])}_functionToNumber(r){var t,e=this._getTypeName(r[0]);return e===o?r[0]:e!==f||(t=+r[0],isNaN(t))?null:t}_functionNotNull(r){for(var t=0;t<r.length;t++)if(this._getTypeName(r[t])!==p)return r[t];return null}_functionSort(r){var t=r[0].slice(0);return t.sort(),t}_functionSortBy(r){if(!this._interpreter)return[];var t=r[0].slice(0);if(0===t.length)return t;var e=this._interpreter,n=r[1],i=this._getTypeName(e.visit(n,t[0]));if(void 0!==i&&[o,f].indexOf(i)<0)throw new Error("TypeError");for(var u=this,a=[],s=0;s<t.length;s++)a.push([s,t[s]]);a.sort((function(r,t){var a=e.visit(n,r[1]),s=e.visit(n,t[1]);if(u._getTypeName(a)!==i)throw new Error("TypeError: expected "+i+", received "+u._getTypeName(a));if(u._getTypeName(s)!==i)throw new Error("TypeError: expected "+i+", received "+u._getTypeName(s));return a>s?1:a<s?-1:r[0]-t[0]}));for(var c=0;c<a.length;c++)t[c]=a[c][1];return t}_functionMaxBy(r){for(var t,e,n=r[0],i=this.createKeyFunction(r[1],[o,f]),u=-1/0,a=0;a<n.length;a++)(e=i&&i(n[a]))>u&&(u=e,t=n[a]);return t}_functionMinBy(r){for(var t,e,n=r[0],i=this.createKeyFunction(r[1],[o,f]),u=1/0,a=0;a<n.length;a++)(e=i&&i(n[a]))<u&&(u=e,t=n[a]);return t}createKeyFunction(r,t){if(this._interpreter){var e=this,n=this._interpreter;return function(i){var u=n.visit(r,i);if(t.indexOf(e._getTypeName(u))<0){var a="TypeError: expected one of "+t+", received "+e._getTypeName(u);throw new Error(a)}return u}}}}return function(r,t){var e=new X,n=new tr,i=new rr(n);n._interpreter=i;var u=e.parse(t);return i.search(u,r)}(t,r)},E=0,k={},O=URL.createObjectURL(new Blob(["$$="+j+";onmessage="+function(r){Promise.resolve(r.data[1]).then((function(r){return $$.apply($$,r)})).then((function(t){postMessage([r.data[0],0,t],[t].filter((function(r){return r instanceof ArrayBuffer||r instanceof MessagePort||self.ImageBitmap&&r instanceof ImageBitmap})))}),(function(t){postMessage([r.data[0],1,""+t])}))}])),(A=new Worker(O)).onmessage=function(r){k[r.data[0]][r.data[1]](r.data[2]),k[r.data[0]]=null},function(r){return r=[].slice.call(arguments),new Promise((function(){k[++E]=arguments,A.postMessage([E,r],r.filter((function(r){return r instanceof ArrayBuffer||r instanceof MessagePort||self.ImageBitmap&&r instanceof ImageBitmap})))}))});var j,E,k,O,A;e.defineScale("genome",{base:1,k:1e3,M:1e6,G:1e9,T:1e12,P:1e15,E:1e18,Z:1e21,Y:1e24},1),e.defineScale("filesize",{"":1,k:1024,M:1048576,G:1024**3,T:1024**4,P:1024**5},1);const S=w(["number","number"]),x=w({x:"number",y:"number"}),M=w([S]),N=w([x]),I=async(r,t)=>"string"==typeof r||Array.isArray(r)?r:Promise.all(Object.entries(r).map(async([r,e])=>P(r,e,t))),P=async(r,t,n)=>{let i,u,a,s,o,c;switch(r){case"fn:sum":return(i=(await I(t,n))[0]||[]).reduce((r,t)=>r+t,0);case"fn:divide":return[o,c]=t,(o="number"==typeof o?o:(await I(o,n))[0]||0)/("number"==typeof c?c:(await I(c,n))[0]||0);case"fn:mod":return[o,c]=t,(o="number"==typeof o?o:(await I(o,n))[0]||0)%("number"==typeof c?c:(await I(c,n))[0]||0);case"fn:formatNumber":[u,a,s]=t,i=(await I(u,n))[0]||0;let r=e(i,{precision:a,recursive:2,scale:"SI",unit:s||""});return`${r="string"==typeof r?r:r[0]}${"1"===(/\d+/g.exec(r)||[])[0]?"":"s"}`;case"fn:toFixed":return[u,a]=t,i=(await I(u,n))[0]||0,Number.parseFloat(i).toFixed(a);case"fn:mode":return[u,a]=t,(i=(i=(await I(u,n))[0]||0).sort((r,t)=>r-t).reduce((r,t)=>{const e=Number.parseFloat(t).toFixed(a);return r[e]=(r[e]||0)+1,r[e]>=r.modeCount&&(r.mode=t,r.modeCount=r[e]),r},{mode:0,modeCount:0})).mode;case"fn:uniq":return(i=(await I(t,n))[0]||[]).reduce((r,t)=>(!r.includes(t)&&r.push(t),r),[]);case"fn:map":return Promise.all(t.map(async r=>Object.assign({},...await Promise.all(Object.entries(r).map(async([r,t])=>{const e=await I(t,n);return{[r]:"string"==typeof e?e:e[0]}})))));case"fn:round":return Math.round((await I(t,n))[0]||0);case"fn:count":return(await I(t,n))[0].length;case"fn:average":const f=(await I(t,n))[0]||[];return f.reduce((r,t)=>r+t,0)/(f.length||1);case"fn:jmespath":return g(t,n)}return{[r]:t}},R=async(r,t)=>{if("string"==typeof t)return t;const[e]=await I(t,r);return Array.isArray(e)?(r=>{if(!Array.isArray(r))return r;try{return M(r),r.map(([r,t])=>({x:r,y:t}))}catch(t){}try{return N(r),Object.entries(r.reduce((r,{x:t,y:e})=>0===e?r:(r[t]=r[t]?r[t]+e:e,r),{})).map(r=>({x:+r[0],y:r[1]}))}catch(t){}return r})(e):"number"==typeof e?e.toLocaleString():e},T=async(r,t)=>Object.assign({},...await Promise.all(Object.entries(r).filter(([r])=>r.startsWith("@")).map(async([r,e])=>({[r.substr(1)]:await R(t,e)}))));export{T as m,R as p};